{"filter":false,"title":"app.js","tooltip":"/YelpCamp/v7/app.js","undoManager":{"mark":11,"position":11,"stack":[[{"start":{"row":54,"column":0},"end":{"row":112,"column":3},"action":"remove","lines":["app.get(\"/campground\",function(req,res){","    ","    Campground.find({},function(err,allCampGrounds){","        if(err){","            console.log(err);","        }","        else{","            //console.log(allCampGrounds);","            console.log(\"alll camps\");","            res.render('campground/campground.ejs', {campgrounds:allCampGrounds});","        }","    });","   ","    ","})","","app.post(\"/campground\",function(req,res){","    var newCamp ={","        name:req.body.name,","        image:req.body.url,","        description:req.body.description","    }","    //campgrounds.push(newCamp);","    Campground.create(newCamp,function(err,camp){","        if(err){","            console.log(err);","        }","        else{","            console.log(camp);","            console.log(\"added new camp\");","        }","    })","    console.log(\"In the post methods\");","    res.redirect(\"/campground\");","})","","","","app.get(\"/campground/new\",isLoggedIn,function(req,res){","    ","    ","    res.render(\"campground/new.ejs\");","    ","})","","app.get(\"/campground/:id\",function(req,res){","    console.log(\"in get of id\");","    Campground.findById(req.params.id).populate(\"comments\").exec(function(err, camp){","       if(err){","           console.log(err);","       } ","       else{","           console.log(\"find by id \");","           //console.log(camp);","           res.render(\"campground/show.ejs\",{camp:camp})","       }","        ","    });","});"],"id":2}],[{"start":{"row":88,"column":0},"end":{"row":123,"column":2},"action":"remove","lines":["// get form for registration","app.get(\"/register\",function(req,res){","    res.render(\"register\");","})","","// to post from the form to  this route","app.post(\"/register\",function(req,res){","    var newUser = new User({username:req.body.username})","    User.register(newUser, req.body.password, function(err,user){","        if(err){","            console.log(err);","            return res.render(\"register\");","        }","        passport.authenticate(\"local\")(req,res,function(){","           return res.redirect(\"/campground\");","        });","    });","});","","","app.get(\"/login\",function(req, res) {","    res.render(\"login\");","})","","app.post(\"/login\",passport.authenticate(\"local\",","    {successRedirect:\"/campground\",","    failureRedirect:\"/login\"}","    )","    ,function(req, res) {","    //res.send(\"in login\");","})","","app.get(\"/logout\",function(req, res) {","    req.logout();","    res.redirect(\"/campground\")","})"],"id":3}],[{"start":{"row":90,"column":0},"end":{"row":95,"column":1},"action":"remove","lines":["function isLoggedIn(req,res,next){","    if(req.isAuthenticated()){","       return  next();","    }","     res.redirect(\"/login\");","}"],"id":4}],[{"start":{"row":48,"column":0},"end":{"row":53,"column":0},"action":"remove","lines":["app.get(\"/\",function(req,res){","    console.log(\"here in langasdfasdfsd\");","    res.render('startPage.ejs');","    ","})",""],"id":5}],[{"start":{"row":51,"column":0},"end":{"row":83,"column":0},"action":"remove","lines":["app.get(\"/campground/:id/comments/new\",isLoggedIn,function(req,res){","    Campground.findById(req.params.id,function(err,camp){","        if(err){","            console.log(err);","        }","        else{","            res.render(\"comment/new.ejs\",{camp,camp}); ","        }","    });","});","app.post(\"/campground/:id/comments\",isLoggedIn,function(req,res){","    Campground.findById(req.params.id,function(err,camp){","        if(err){","            console.log(err);","        }","        else{","           Comment.create(req.body.comment,function(err,comment){","              if(err){","                  console.log(err);","              } ","              else{","                  //console.log(comment);","                  camp.comments.push(comment);","                  camp.save();","                  console.log(camp);","                  res.redirect(\"/campground/\"+camp._id);","              }","           });","        }","    });","});","",""],"id":6}],[{"start":{"row":49,"column":0},"end":{"row":51,"column":52},"action":"insert","lines":["app.use(\"/\", indexRoutes);","app.use(\"/campgrounds\", campgroundRoutes);","app.use(\"/campgrounds/:id/comments\", commentRoutes);"],"id":7}],[{"start":{"row":11,"column":0},"end":{"row":12,"column":0},"action":"insert","lines":["",""],"id":8}],[{"start":{"row":12,"column":0},"end":{"row":14,"column":48},"action":"insert","lines":["var commentRoutes    = require(\"./routes/comments\"),","    campgroundRoutes = require(\"./routes/campgrounds\"),","    indexRoutes      = require(\"./routes/index\")"],"id":9}],[{"start":{"row":11,"column":0},"end":{"row":11,"column":1},"action":"insert","lines":["/"],"id":10},{"start":{"row":11,"column":1},"end":{"row":11,"column":2},"action":"insert","lines":["/"]},{"start":{"row":11,"column":2},"end":{"row":11,"column":3},"action":"insert","lines":["r"]},{"start":{"row":11,"column":3},"end":{"row":11,"column":4},"action":"insert","lines":["o"]},{"start":{"row":11,"column":4},"end":{"row":11,"column":5},"action":"insert","lines":["u"]},{"start":{"row":11,"column":5},"end":{"row":11,"column":6},"action":"insert","lines":["t"]},{"start":{"row":11,"column":6},"end":{"row":11,"column":7},"action":"insert","lines":["e"]},{"start":{"row":11,"column":7},"end":{"row":11,"column":8},"action":"insert","lines":["s"]}],[{"start":{"row":13,"column":51},"end":{"row":13,"column":52},"action":"remove","lines":["s"],"id":11}],[{"start":{"row":53,"column":20},"end":{"row":53,"column":21},"action":"remove","lines":["s"],"id":12}],[{"start":{"row":54,"column":20},"end":{"row":54,"column":21},"action":"remove","lines":["s"],"id":13}]]},"ace":{"folds":[],"scrolltop":602,"scrollleft":0,"selection":{"start":{"row":64,"column":2},"end":{"row":64,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":36,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1580703679887,"hash":"0c8aee4b8e4333b9deab9eaa7990ae2bcbad6613"}