{"filter":false,"title":"index.js","tooltip":"/YelpCamp/v11/routes/index.js","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":56,"column":24},"action":"remove","lines":["var express = require(\"express\");","var router  = express.Router();","var passport = require(\"passport\");","var User = require(\"../models/user\");","","//root route","router.get(\"/\", function(req, res){","    res.render(\"landing\");","});","","// show register form","router.get(\"/register\", function(req, res){","   res.render(\"register\"); ","});","","//handle sign up logic","router.post(\"/register\", function(req, res){","    var newUser = new User({username: req.body.username});","    User.register(newUser, req.body.password, function(err, user){","        if(err){","            console.log(err);","            return res.render(\"register\");","        }","        passport.authenticate(\"local\")(req, res, function(){","           res.redirect(\"/campgrounds\"); ","        });","    });","});","","//show login form","router.get(\"/login\", function(req, res){","   res.render(\"login\"); ","});","","//handling login logic","router.post(\"/login\", passport.authenticate(\"local\", ","    {","        successRedirect: \"/campgrounds\",","        failureRedirect: \"/login\"","    }), function(req, res){","});","","// logout route","router.get(\"/logout\", function(req, res){","   req.logout();","   res.redirect(\"/campgrounds\");","});","","//middleware","function isLoggedIn(req, res, next){","    if(req.isAuthenticated()){","        return next();","    }","    res.redirect(\"/login\");","}","","module.exports = router;"],"id":2},{"start":{"row":0,"column":0},"end":{"row":52,"column":24},"action":"insert","lines":["var express = require(\"express\");","var router  = express.Router();","var passport = require(\"passport\");","var User = require(\"../models/user\");","","//root route","router.get(\"/\", function(req, res){","    res.render(\"landing\");","});","","// show register form","router.get(\"/register\", function(req, res){","   res.render(\"register\"); ","});","","//handle sign up logic","router.post(\"/register\", function(req, res){","    var newUser = new User({username: req.body.username});","    User.register(newUser, req.body.password, function(err, user){","        if(err){","            req.flash(\"error\", err.message);","            return res.render(\"register\");","        }","        passport.authenticate(\"local\")(req, res, function(){","           req.flash(\"success\", \"Welcome to YelpCamp \" + user.username);","           res.redirect(\"/campgrounds\"); ","        });","    });","});","","//show login form","router.get(\"/login\", function(req, res){","   res.render(\"login\"); ","});","","//handling login logic","router.post(\"/login\", passport.authenticate(\"local\", ","    {","        successRedirect: \"/campgrounds\",","        failureRedirect: \"/login\"","    }), function(req, res){","});","","// logout route","router.get(\"/logout\", function(req, res){","   req.logout();","   req.flash(\"success\", \"Logged you out!\");","   res.redirect(\"/campgrounds\");","});","","","","module.exports = router;"]}]]},"ace":{"folds":[],"scrolltop":300,"scrollleft":0,"selection":{"start":{"row":46,"column":43},"end":{"row":46,"column":43},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":17,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1580717541505,"hash":"2259bfd8251f18aec14193306bed59b4009295f6"}